<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QR Scavenger Hunts</title>

<style>
:root{
  --bg:#f4f6f8;
  --card:#ffffff;
  --accent:#2563eb;
  --text:#111827;
}
body{
  margin:0;
  font-family: system-ui,-apple-system,sans-serif;
  background:var(--bg);
  color:var(--text);
}
.theme-blue{--accent:#2563eb;}
.theme-red{--accent:#dc2626;}
.theme-green{--accent:#16a34a;}
.theme-purple{--accent:#7c3aed;}
.theme-dark{
  --bg:#0f172a;
  --card:#020617;
  --text:#e5e7eb;
  --accent:#38bdf8;
}
.card{max-width:900px;margin:auto;padding:20px;}
.hunt{
  background:var(--card);
  padding:14px;
  border-radius:12px;
  margin-bottom:14px;
  border:1px solid #ddd;
}
.admin{border:2px dashed #dc2626;}
button{
  padding:12px 18px;
  border-radius:12px;
  border:none;
  background:var(--accent);
  color:white;
  font-size:16px;
  cursor:pointer;
  margin:4px 4px 4px 0;
}
button.secondary{background:#6b7280;}
button.danger{background:#dc2626;}
textarea,input,select{
  width:100%;
  padding:10px;
  margin-bottom:10px;
  font-size:16px;
}
.center-screen{
  min-height:100vh;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  text-align:center;
  padding:20px;
}
.center-screen h1{font-size:2.3rem;}
.center-screen p{font-size:1.6rem;max-width:800px;}
.bottom-bar{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  padding:16px;
  display:flex;
  justify-content:center;
}
video{
  width:100%;
  max-width:420px;
  border-radius:12px;
  margin-top:12px;
}
.admin-footer{
  margin-top:20px;
  padding-top:10px;
  border-top:1px solid #ccc;
  font-size:14px;
}
.admin-footer a{
  color:#dc2626;
  font-weight:bold;
  text-decoration:none;
}
ol li{font-size:1.1rem;}
</style>
</head>

<body>
<div class="card" id="app"></div>

<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jsqr/dist/jsQR.js"></script>

<script>
/* ================= CONFIG ================= */
const ADMIN_PIN = "318933";
const ADMIN_EMAIL = "Hayden_333@hotmail.com";

/* ================= UTIL ================= */
function uid(){ return Math.random().toString(36).slice(2,9); }
function isDefaultHunt(key){
  return Object.prototype.hasOwnProperty.call(DEFAULT_HUNTS, key);
}

/* ================= ADMIN ================= */
let isAdmin = sessionStorage.getItem("admin")==="1";

function toggleAdmin(){
  if(isAdmin){
    isAdmin=false;
    sessionStorage.removeItem("admin");
    home();
    return;
  }
  const pin = prompt("Enter Admin PIN:");
  if(pin === ADMIN_PIN){
    isAdmin=true;
    sessionStorage.setItem("admin","1");
    home();
  } else alert("Incorrect PIN");
}

/* ================= DEFAULT HUNTS ================= */
const DEFAULT_HUNTS={
  escape:{
    name:"Escape the House",
    theme:"blue",
    intro:"Welcome! Your escape challenge begins now üè†",
    clues:[
      "I show your face but I'm not a photo.",
      "I have pages but no homework.",
      "I keep food safe and cold.",
      "I go round and round but never get dizzy.",
      "I have hands but no arms.",
      "I hide your feet when you're not home.",
      "I'm soft, comfy, and steal naps.",
      "I light the dark when switched on.",
      "I'm full of secrets behind closed doors.",
      "The prize is hidden where valuables stay safe."
    ],
    finish:"üéâ Congratulations! You escaped the house!"
  },
  fortnite:{
    name:"Fortnite IRL",
    theme:"purple",
    intro:"Drop in! Your real-world Fortnite challenge starts now üéÆ",
    clues:[
      "Controllers land here after a match.",
      "Drinks restore shields here.",
      "Shoes hide here after the storm.",
      "Materials are stored with tools.",
      "The squad gathers here.",
      "You can‚Äôt win without sleep.",
      "Secrets behind closed doors.",
      "Devices recharge here.",
      "High ground advantage.",
      "Where battles are watched.",
      "Snacks disappear here.",
      "Victory Royale location."
    ],
    finish:"üèÜ Victory Royale! You completed the hunt!"
  },
  hacker:{
    name:"System Breach",
    theme:"dark",
    intro:"‚ö†Ô∏è Incoming transmission‚Ä¶ system access required.",
    clues:[
      "Device that controls all others.",
      "Passwords written but not digital.",
      "Cold data storage.",
      "Where commands are typed.",
      "Single click changes everything.",
      "Primary power source.",
      "Clothes reset location.",
      "Backup storage area.",
      "Display output surface.",
      "Permission checkpoint.",
      "Hidden encrypted space.",
      "Logs of activity.",
      "User rest zone.",
      "Final access node.",
      "Root access payload location."
    ],
    finish:"‚úÖ SYSTEM BREACH COMPLETE ‚Äî ACCESS GRANTED."
  }
};

let userHunts = JSON.parse(localStorage.getItem("userHunts")||"{}");
let HUNTS = {...DEFAULT_HUNTS, ...userHunts};
function save(){ localStorage.setItem("userHunts", JSON.stringify(userHunts)); }

/* ================= ROUTER ================= */
const q = new URLSearchParams(location.search);
const app = document.getElementById("app");

if(q.get("play")) play();
else if(q.get("view")) viewHunt(q.get("view"));
else if(q.get("edit")) createHunt(q.get("edit"));
else if(q.get("new")) createHunt();
else home();

/* ================= HOME ================= */
function home(){
  document.body.className="";
  app.innerHTML=`
    <h1>QR Scavenger Hunts</h1>
    <button onclick="location='?new=1'">‚ûï Create New Hunt</button>
    <button class="secondary" onclick="toggleAdmin()">
      ${isAdmin?"üîì Exit Admin":"üîí Admin"}
    </button>
